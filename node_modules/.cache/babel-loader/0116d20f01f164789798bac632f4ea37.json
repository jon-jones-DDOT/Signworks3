{"ast":null,"code":"import _objectSpread from \"C:\\\\Projects\\\\Signworks3\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"C:\\\\Projects\\\\Signworks3\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport _classCallCheck from \"C:\\\\Projects\\\\Signworks3\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Projects\\\\Signworks3\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Projects\\\\Signworks3\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Projects\\\\Signworks3\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Projects\\\\Signworks3\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _taggedTemplateLiteral from \"C:\\\\Projects\\\\Signworks3\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"C:\\\\Projects\\\\Signworks3\\\\src\\\\components\\\\esri\\\\map\\\\SceneViewExample.js\";\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  height: 100%;\\n  width: 100%;\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\n// Copyright 2019 Esri Licensed under the Apache License, Version 2.0 (the\n// \"License\"); you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n// http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law\n// or agreed to in writing, software distributed under the License is\n// distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n// KIND, either express or implied. See the License for the specific language\n// governing permissions and limitations under the License.​ NOTE This is a\n// \"special\" react component that does not strictly play by React's rules.\n//\n// Conceptually, this component creates a \"portal\" in React by closing its\n// render method off from updates (by simply rendering a div and never accepting\n// re-renders) then reconnecting itself to the React lifecycle by listening for\n// any new props (using componentWillReceiveProps) React\nimport React, { Component } from 'react'; // Redux\n\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { actions as mapActions } from '../../../redux/reducers/map'; // ESRI\n\nimport { loadModules } from 'esri-loader';\nimport { createView } from '../../../utils/esriHelper'; // Styled Components\n\nimport styled from 'styled-components';\nimport { pointToExtent } from '../../../utils/JSAPI';\nvar Container = styled.div(_templateObject()); // Variables\n\nvar containerID = \"map-view-container\";\n\nvar SceneViewExample =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(SceneViewExample, _Component);\n\n  function SceneViewExample() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, SceneViewExample);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(SceneViewExample)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this.startup = function (mapConfig, node) {\n      var isScene = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      createView(mapConfig, node, isScene).then(function (response) {\n        _this.init(response);\n\n        _this.setupEventHandlers(_this.map);\n\n        _this.setupWidgetsAndLayers();\n\n        _this.finishedLoading();\n      }, function (error) {\n        console.error(\"maperr\", error);\n        window.setTimeout(function () {\n          _this.startup(mapConfig, node);\n        }, 1000);\n      });\n    };\n\n    _this.finishedLoading = function () {\n      // Update app state only after map and widgets are loaded\n      _this.props.onMapLoaded();\n    };\n\n    _this.getSelectedSupport = function (expandedMapPoint) {\n      _this.props.onMapClicked(expandedMapPoint, _this.map.findLayerById('support'));\n    };\n\n    _this.mapClicked = function (evt) {\n      pointToExtent(_this.view, evt.mapPoint, 40, _this.getSelectedSupport);\n    };\n\n    _this.init = function (response) {\n      _this.view = response.view;\n      _this.map = response.view.map;\n    };\n\n    _this.setupWidgetsAndLayers = function () {\n      loadModules(['esri/layers/FeatureLayer']).then(function (_ref) {\n        var _ref2 = _slicedToArray(_ref, 1),\n            FeatureLayer = _ref2[0];\n\n        var featureLayer = new FeatureLayer({\n          url: \"https://dcdot.esriemcs.com/server/rest/services/Signs/SignWorks_Test/FeatureServ\" + \"er/0\",\n          outFields: [\"*\"],\n          id: \"support\"\n        });\n\n        _this.map.add(featureLayer);\n\n        featureLayer.when(function () {\n          zoomToLayer(featureLayer);\n        });\n\n        var zoomToLayer = function zoomToLayer(layer) {\n          alert('fred');\n          return layer.queryExtent().then(function (response) {\n            _this.view.goTo(response.extent);\n          });\n        };\n      });\n    };\n\n    _this.setupEventHandlers = function (map) {\n      alert('bob1');\n      loadModules(['esri/layers/FeatureLayer'], function (FeatureLayer) {\n        _this.view.on(\"click\", _this.mapClicked);\n\n        alert('bob2');\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(SceneViewExample, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.startup(this.props.mapConfig, containerID, this.props.is3DScene);\n    }\n  }, {\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps, nextState) {\n      // Tell React to never update this component, that's up to us\n      return false;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(Container, {\n        ref: \"mapDiv\",\n        id: containerID,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 53\n        },\n        __self: this\n      });\n    } // ESRI JSAPI\n\n  }]);\n\n  return SceneViewExample;\n}(Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    config: state.config,\n    map: state.map\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return bindActionCreators(_objectSpread({}, mapActions), dispatch);\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SceneViewExample);","map":{"version":3,"sources":["C:\\Projects\\Signworks3\\src\\components\\esri\\map\\SceneViewExample.js"],"names":["React","Component","connect","bindActionCreators","actions","mapActions","loadModules","createView","styled","pointToExtent","Container","div","containerID","SceneViewExample","startup","mapConfig","node","isScene","then","response","init","setupEventHandlers","map","setupWidgetsAndLayers","finishedLoading","error","console","window","setTimeout","props","onMapLoaded","getSelectedSupport","expandedMapPoint","onMapClicked","findLayerById","mapClicked","evt","view","mapPoint","FeatureLayer","featureLayer","url","outFields","id","add","when","zoomToLayer","layer","alert","queryExtent","goTo","extent","on","is3DScene","nextProps","nextState","mapStateToProps","state","config","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["// Copyright 2019 Esri Licensed under the Apache License, Version 2.0 (the\r\n// \"License\"); you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n// http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law\r\n// or agreed to in writing, software distributed under the License is\r\n// distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n// KIND, either express or implied. See the License for the specific language\r\n// governing permissions and limitations under the License.​ NOTE This is a\r\n// \"special\" react component that does not strictly play by React's rules.\r\n//\r\n// Conceptually, this component creates a \"portal\" in React by closing its\r\n// render method off from updates (by simply rendering a div and never accepting\r\n// re-renders) then reconnecting itself to the React lifecycle by listening for\r\n// any new props (using componentWillReceiveProps) React\r\nimport React, {Component} from 'react';\r\n\r\n// Redux\r\nimport {connect} from 'react-redux';\r\nimport {bindActionCreators} from 'redux';\r\nimport {actions as mapActions} from '../../../redux/reducers/map';\r\n\r\n// ESRI\r\nimport {loadModules} from 'esri-loader';\r\nimport {createView} from '../../../utils/esriHelper';\r\n\r\n// Styled Components\r\nimport styled from 'styled-components';\r\n\r\nimport {pointToExtent} from '../../../utils/JSAPI';\r\n\r\nconst Container = styled.div `\r\n  height: 100%;\r\n  width: 100%;\r\n`;\r\n\r\n// Variables\r\nconst containerID = \"map-view-container\";\r\n\r\nclass SceneViewExample extends Component {\r\n\r\n    componentDidMount() {\r\n        this.startup(this.props.mapConfig, containerID, this.props.is3DScene);\r\n    }\r\n\r\n    shouldComponentUpdate(nextProps, nextState) {\r\n        // Tell React to never update this component, that's up to us\r\n        return false;\r\n    }\r\n\r\n    render() {\r\n\r\n        return (\r\n            <Container ref=\"mapDiv\" id={containerID}></Container>\r\n        );\r\n    }\r\n\r\n    // ESRI JSAPI\r\n    startup = (mapConfig, node, isScene = false) => {\r\n        createView(mapConfig, node, isScene).then(response => {\r\n            this.init(response);\r\n\r\n            this.setupEventHandlers(this.map);\r\n            this.setupWidgetsAndLayers();\r\n            this.finishedLoading();\r\n        }, error => {\r\n            console.error(\"maperr\", error);\r\n            window.setTimeout(() => {\r\n                this.startup(mapConfig, node);\r\n            }, 1000);\r\n        })\r\n    }\r\n\r\n    finishedLoading = () => {\r\n        // Update app state only after map and widgets are loaded\r\n        this\r\n            .props\r\n            .onMapLoaded();\r\n    }\r\n\r\n    getSelectedSupport = (expandedMapPoint) => {\r\n        this\r\n            .props\r\n            .onMapClicked(expandedMapPoint, this.map.findLayerById('support'));\r\n    }\r\n\r\n    mapClicked = (evt) => {\r\n\r\n        pointToExtent(this.view, evt.mapPoint, 40, this.getSelectedSupport);\r\n\r\n    }\r\n\r\n    init = (response) => {\r\n        this.view = response.view\r\n        this.map = response.view.map;\r\n    }\r\n\r\n    setupWidgetsAndLayers = () => {\r\n        loadModules(['esri/layers/FeatureLayer']).then(([FeatureLayer]) => {\r\n\r\n            const featureLayer = new FeatureLayer({\r\n                url: \"https://dcdot.esriemcs.com/server/rest/services/Signs/SignWorks_Test/FeatureServ\" +\r\n                        \"er/0\",\r\n                outFields: [\"*\"],\r\n                id: \"support\"\r\n            });\r\n            this\r\n                .map\r\n                .add(featureLayer);\r\n\r\n            featureLayer.when(function () {\r\n               \r\n                zoomToLayer(featureLayer);\r\n            });\r\n\r\n            const zoomToLayer = (layer) => {\r\n              alert('fred')\r\n                return layer\r\n                    .queryExtent()\r\n                    .then((response) => {\r\n                        this\r\n                            .view\r\n                            .goTo(response.extent);\r\n                    });\r\n            }\r\n        });\r\n    }\r\n\r\n    setupEventHandlers = (map) => {\r\n        alert('bob1')\r\n        loadModules(['esri/layers/FeatureLayer'], (FeatureLayer) => {\r\n\r\n            this\r\n                .view\r\n                .on(\"click\", this.mapClicked)\r\n            alert('bob2')\r\n        });\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => ({config: state.config, map: state.map});\r\n\r\nconst mapDispatchToProps = function (dispatch) {\r\n    return bindActionCreators({\r\n        ...mapActions\r\n    }, dispatch);\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SceneViewExample);\r\n"]},"metadata":{},"sourceType":"module"}